# 성경통독 파이프라인

100일 성경통독 영상 자동 생성 시스템 (106개 에피소드)

## 파이프라인 흐름

```
┌─────────────────────────────────────────────────────────┐
│  1. BIBLE 시트에서 상태='대기' 에피소드 조회            │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  2. TTS 생성 (절 번호 제외, 본문만 낭독)                │
│     └── Gemini TTS (chirp3:Charon) - 차분한 목소리     │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  3. 배경 이미지 확인/생성                               │
│     ├── 구약: 파란색 계열 그라데이션                   │
│     └── 신약: 붉은색 계열 그라데이션                   │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  4. 썸네일 생성                                         │
│     └── "100일 성경통독 Day X / 창세기1장~15장"        │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  5. 영상 렌더링 (FFmpeg)                                │
│     ├── 배경 이미지 + TTS 오디오                       │
│     └── ASS 자막 (절 번호 포함, 페이드 효과 300ms)     │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  6. YouTube 업로드                                       │
│     └── 플레이리스트, 예약 공개 지원                   │
└─────────────────────────────────────────────────────────┘
```

## BIBLE 시트 구조

| 컬럼 | 설명 |
|------|------|
| 에피소드 | EP001 ~ EP106 |
| 책 | 창세기, 출애굽기, ... |
| 시작장 | 시작 장 번호 |
| 끝장 | 끝 장 번호 |
| 예상시간(분) | TTS 예상 재생 시간 |
| 글자수 | 총 텍스트 길이 |
| 상태 | (빈칸)/대기/처리중/완료/실패 |
| 제목 | 자동 생성 |
| 음성 | TTS 음성 (기본: chirp3:Charon) |
| 공개설정 | public/private/unlisted |
| 예약시간 | YouTube 예약 공개 시간 |
| 플레이리스트ID | YouTube 플레이리스트 ID |
| 영상URL | 업로드된 YouTube URL |
| 에러메시지 | 실패 시 에러 |

## API 사용법

```bash
# BIBLE 시트 생성 (106개 에피소드 자동 등록)
curl "https://drama-s2ns.onrender.com/api/sheets/create-bible"

# 채널 ID 포함
curl "https://drama-s2ns.onrender.com/api/sheets/create-bible?channel_id=UCxxx"

# 영상 생성 파이프라인 실행 (cron job)
curl -X POST "https://drama-s2ns.onrender.com/api/bible/check-and-process"
```

## 참고 파일

- `scripts/bible_pipeline/run.py` - 에피소드 분할 로직 (106개)
- `scripts/bible_pipeline/config.py` - 설정 (TTS 음성, 시트 헤더)
- `scripts/bible_pipeline/sheets.py` - Google Sheets 연동
- `scripts/bible_pipeline/thumbnail.py` - 썸네일 생성
- `scripts/bible_pipeline/renderer.py` - ASS 자막 + FFmpeg 영상 렌더링
- `scripts/bible_pipeline/background.py` - 배경 이미지 생성
