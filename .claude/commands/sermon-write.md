# /sermon-write - 설교문 작성

설교문 작성 요청을 확인하고 직접 작성합니다.

## 실행 방법

1. **대기 중인 요청 확인**
   ```bash
   curl "http://localhost:5059/api/sermon/pending"
   ```
   또는 Render 서버:
   ```bash
   curl "https://drama-s2ns.onrender.com/api/sermon/pending"
   ```

2. **요청이 있으면 설교문 작성**

3. **작성 완료 후 저장**
   ```bash
   curl -X POST "http://localhost:5059/api/sermon/save" \
     -H "Content-Type: application/json" \
     -d '{
       "sheet_name": "시트명",
       "row_number": 행번호,
       "sermon": "작성된 설교문..."
     }'
   ```

## 설교문 작성 지침

### 1. 본문 분석
- 역사적, 문화적, 신학적 배경
- 문학적 구조와 맥락
- 원어(히브리어/헬라어) 핵심 단어 1-2개 설명

### 2. 설교 구조
- **서론 (10%)**: 주의 집중, 본문 소개
- **본론 (80%)**: 핵심 메시지 전개 (2-3개 포인트)
- **결론 (10%)**: 적용점, 도전

### 3. 분량 기준 (시트명 기반)
| 시트명 | 분량 | 글자 수 |
|--------|------|---------|
| 새벽기도/새벽 | 10분 | ~2,500자 |
| 수요예배/수요 | 20분 | ~5,000자 |
| 청년부/청년 | 25분 | ~6,500자 |
| 주일예배/주일 | 30분 | ~8,000자 |
| 그 외 | 20분 | ~5,000자 |

※ 요청사항에 분량이 지정되어 있으면 그것을 우선

### 4. 출력 형식

```markdown
# [설교 제목]

**본문**: [성경 본문]

## 서론

[서론 내용]

## 본론

### 1. [첫 번째 포인트]

[내용]

### 2. [두 번째 포인트]

[내용]

### 3. [세 번째 포인트]

[내용]

## 결론

[결론 및 적용]

---

**핵심 메시지**: [한 문장으로 요약]
```

## 수정 요청 처리

상태가 "수정요청"이고 피드백이 있는 경우:
1. 기존 설교문(D열)과 피드백(E열) 확인
2. 피드백 반영하여 수정
3. 수정본을 F열(수정본)에 저장

```bash
curl -X POST "http://localhost:5059/api/sermon/save" \
  -H "Content-Type: application/json" \
  -d '{
    "sheet_name": "시트명",
    "row_number": 행번호,
    "sermon": "수정된 설교문...",
    "is_revision": true
  }'
```

## 시트 구조

| 컬럼 | 헤더 | 설명 |
|------|------|------|
| A | 상태 | 요청/처리중/완료/실패 |
| B | 본문 | 성경 본문 |
| C | 요청사항 | 분량, 대상, 방향 등 |
| D | 설교문 | 작성된 설교문 |
| E | 피드백 | 수정 요청 시 피드백 |
| F | 수정본 | 피드백 반영 수정본 |
| G | 작성일시 | 완료 시간 |
| H | 에러메시지 | 실패 시 에러 |

## 새 시트 초기화

```bash
curl -X POST "http://localhost:5059/api/sermon/init-sheet" \
  -H "Content-Type: application/json" \
  -d '{"sheet_name": "금요철야"}'
```
