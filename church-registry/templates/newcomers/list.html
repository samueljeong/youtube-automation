{% extends "base.html" %}

{% block title %}새신자 관리{% endblock %}

{% block content %}
<div class="container">
    <!-- 페이지 헤더 -->
    <div class="page-header">
        <div>
            <h1 class="page-title">
                <i class="bi bi-person-plus"></i>
                새신자 관리
            </h1>
            <p class="page-subtitle">총 {{ newcomers|length }}명의 새신자가 있습니다</p>
        </div>
        <a href="{{ url_for('member_new') }}" class="btn-submit">
            <i class="bi bi-plus-lg"></i> 새신자 등록
        </a>
    </div>

    {% if newcomers %}
    <!-- 새신자 카드 그리드 -->
    <div class="card-grid">
        {% for member in newcomers %}
        <a href="{{ url_for('member_detail', member_id=member.id) }}" class="member-card">
            <div class="member-card-header">
                <div class="member-avatar" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                    {% if member.photo_url %}
                    <img src="{{ member.photo_url }}" alt="{{ member.name }}">
                    {% else %}
                    {{ member.name[0] }}
                    {% endif %}
                </div>
                <div class="member-info">
                    <h3>{{ member.name }}</h3>
                    <p>
                        {% if member.registration_date %}
                        {{ member.registration_date.strftime('%Y.%m.%d') }} 등록
                        {% endif %}
                    </p>
                </div>
                <span class="status-badge status-newcomer">새신자</span>
            </div>
            <div class="member-meta">
                {% if member.phone %}
                <span><i class="bi bi-telephone"></i> {{ member.phone }}</span>
                {% endif %}
                {% if member.group %}
                <span><i class="bi bi-people"></i> {{ member.group.name }}</span>
                {% endif %}
                {% if member.age is not none %}
                <span><i class="bi bi-person"></i> {{ member.age }}세</span>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>

    <!-- 빠른 액션 -->
    <div class="form-section" style="margin-top: 24px;">
        <div class="form-section-title">
            <i class="bi bi-lightning"></i>
            빠른 액션
        </div>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            {% for member in newcomers[:5] %}
            <a href="{{ url_for('visit_new') }}?member_id={{ member.id }}" class="apple-btn apple-btn-secondary">
                <i class="bi bi-house-heart"></i> {{ member.name }} 심방
            </a>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <!-- 빈 상태 -->
    <div class="form-section">
        <div class="empty-state">
            <i class="bi bi-person-plus"></i>
            <h3>새신자가 없습니다</h3>
            <p>새로운 교인을 등록해보세요</p>
            <a href="{{ url_for('member_new') }}" class="btn-submit">
                <i class="bi bi-plus-lg"></i> 새신자 등록
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
