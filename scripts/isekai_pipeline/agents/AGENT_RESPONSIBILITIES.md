# 혈영 이세계편 - 에이전트 역할 및 책임 명세서

> **목적**: 60화 시리즈의 스토리 일관성을 유지하면서 고품질 영상 제작

---

## 1. 전체 파이프라인 흐름

```
┌─────────────────────────────────────────────────────────────────┐
│  PlannerAgent (기획)                                            │
│  - Series Bible 기반 에피소드 구조 설계                         │
│  - 씬 구조 (5개: 오프닝/전개/클라이맥스/해결/엔딩)              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  BriefCheckerAgent (기획서 검증)                                │
│  - Series Bible 준수 여부 검증                                  │
│  - 캐릭터 등장 시점 검증 (카이든 2화~, 에이라 12화~ 등)         │
│  ⚠️ 80점 미만 시 재작성                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  ScriptAgent (대본)                                             │
│  - 12,000~15,000자 (13~16분) 대본 작성                         │
│  - 씬 단위로 분할 작성 (토큰 제한 대응)                        │
│  - 무협 소설체 문장, TTS 최적화                                │
└─────────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        ▼                     ▼                     ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│ FormChecker   │     │ VoiceChecker  │     │ FeelChecker   │
│ (문체 검증)    │     │ (말투 검증)    │     │ (감정 검증)    │
│ - 문장 길이    │     │ - 캐릭터 말투  │     │ - 분위기 흐름  │
│ - 문체 일관성  │     │ - 대사 일관성  │     │ - 감정 전환    │
└───────────────┘     └───────────────┘     └───────────────┘
        │                     │                     │
        └─────────────────────┴─────────────────────┘
                              │
                          (80점↑ 통과)
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  ImageAgent (이미지)                                            │
│  - 무협 + 판타지 융합 스타일                                    │
│  - 씬별 이미지 프롬프트 5~12개                                  │
│  - 썸네일 프롬프트 생성                                         │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  YouTubeAgent (메타데이터)                                      │
│  - SEO 최적화 제목 (3가지 스타일)                              │
│  - 검색 친화적 설명                                             │
│  - 태그 및 썸네일 텍스트                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  ReviewAgent (최종 검토)                                        │
│  - 스토리 일관성 최우선 검증                                    │
│  - S/A/B/C/D 등급 산정                                          │
│  ⚠️ C/D등급 시 수정 필요                                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  Workers (실행)                                                 │
│  - TTS 생성 (Gemini)                                           │
│  - 이미지 생성 (Gemini Imagen)                                 │
│  - 영상 렌더링 (FFmpeg)                                        │
│  - YouTube 업로드                                               │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 각 에이전트 상세 책임

### 2.1 PlannerAgent (기획 에이전트)

**역할**: Series Bible 기반 에피소드 기획

**입력**:
- 에피소드 번호 (1~60)
- Series Bible (세계관, 캐릭터, 플롯)
- Episode Framework (파트별 구조)

**출력**:
- 에피소드 기획서 (brief)
- 5씬 구조 설계
- 핵심 포인트 3~5개
- 다음화 예고 훅

**검증 기준**:
| 항목 | 기준 | 실패 시 |
|------|------|---------|
| 구조 완성도 | 5개 씬 모두 정의 | 재작성 |
| Series Bible 준수 | 세계관/캐릭터 일관 | 재작성 |
| 이전화 연속성 | 스토리 이어짐 | 재작성 |

---

### 2.2 BriefCheckerAgent (기획서 검증)

**역할**: 기획서가 Series Bible을 준수하는지 검증

**검증 항목** (100점 만점):
| 항목 | 배점 | 기준 |
|------|------|------|
| Series Bible 준수 | 25점 | 세계관/설정 일관성 |
| 씬 구조 | 25점 | 5씬 완성도 |
| 캐릭터 사용 | 20점 | 등장 시점 준수 |
| 연속성 | 15점 | 이전화와 연결 |
| 클리프행어 | 15점 | 다음화 훅 |

**파트별 캐릭터 등장 가이드**:
- 1부 (1~10화): 무영, 설하(회상), 카이든(2화~)
- 2부 (11~20화): +에이라(12화~)
- 3부 (21~30화): +이그니스(21화~)
- 4부 (31~40화): +마르쿠스(31화~)
- 5부 (41~50화): +혈마 부활
- 6부 (51~60화): 전원

**판정**:
- 80점 이상: 통과
- 60~79점: 수정 필요
- 60점 미만: 재작성

---

### 2.3 ScriptAgent (대본 에이전트)

**역할**: 12,000~15,000자 대본 작성

**★ 최우선 규칙: 스토리 일관성**
- Series Bible 세계관 확인
- 이전 에피소드 연속성 확인
- 캐릭터 등장 시점 확인

**씬 단위 작성 프로세스** (필수):
1. 씬 1 작성 (2,100자) → 저장 → 확인
2. 씬 2 작성 (3,100자) → 저장 → 확인
3. 씬 3 작성 (3,900자) → 저장 → 확인
4. 씬 4 작성 (2,800자) → 저장 → 확인
5. 씬 5 작성 (2,100자) → 저장 → 확인
6. 전체 합본 → 검토

**문체 규칙**:
- 소설체 (태그 없음)
- 문장당 50자 이하
- 한 문단 5줄 이하
- 문장부호 후 공백

---

### 2.4 FormCheckerAgent (문체 검증)

**역할**: 문체/형식 일관성 검증

**검증 항목**:
| 항목 | 기준 |
|------|------|
| 문장 길이 | 50자 이하 |
| 문단 길이 | 5줄 이하 |
| 문장부호 | 규칙 준수 |
| 태그 없음 | [] 등 금지 |

---

### 2.5 VoiceCheckerAgent (말투 검증)

**역할**: 캐릭터 대사 일관성 검증

**캐릭터별 말투**:
- 무영: 짧고 건조, "...했다", 독백 많음
- 카이든: 밝고 친근, "~지!", 반말
- 에이라: 고아체, "~하오", 존칭
- 설하: 부드럽고 걱정, "~요", 존칭

---

### 2.6 FeelCheckerAgent (감정 검증)

**역할**: 분위기/감정 흐름 검증

**검증 항목**:
- 감정 전환 자연스러움
- 긴장-이완 밸런스
- 클라이맥스 임팩트

---

### 2.7 ImageAgent (이미지 에이전트)

**역할**: 무협+판타지 융합 이미지 프롬프트 생성

**스타일 가이드**:
- 무협: 검술, 내공 시각화, 동양풍 의상
- 판타지: 마법, 몬스터, 서양풍 건축
- 융합: 동양 검객 + 서양 판타지 세계

**출력**:
- 씬별 이미지 프롬프트 5~12개
- 썸네일 프롬프트 1개

---

### 2.8 YouTubeAgent (메타데이터 에이전트)

**역할**: SEO 최적화 메타데이터 생성

**출력**:
- 제목 3종 (호기심/정보/감성)
- 설명 (2000자 이내)
- 태그 (15~20개)
- 썸네일 텍스트

---

### 2.9 ReviewAgent (최종 검토 에이전트)

**역할**: 최종 품질 검증

**검토 우선순위**:
1. **Critical (스토리)**: Series Bible 위반, 캐릭터 등장 오류 → 재작성
2. **Major (캐릭터)**: 말투 불일치, 성격 위반 → 수정 필요
3. **Minor (문체)**: 문장 길이 초과 → 권고
4. **Info (분량)**: 글자수 ±10% → 참고

**등급**:
- S: 90점 이상, 즉시 제작
- A: 80~89점, 경미한 수정
- B: 70~79점, 일부 수정
- C: 60~69점, 상당한 수정
- D: 60점 미만, 재작성

---

## 3. 파일 구조

```
scripts/isekai_pipeline/agents/
├── AGENT_RESPONSIBILITIES.md  # 이 문서
├── __init__.py               # 에이전트 export
├── base.py                   # BaseAgent 클래스
├── planner_agent.py          # 기획 에이전트
├── brief_checker_agent.py    # 기획서 검증
├── script_agent.py           # 대본 에이전트
├── form_checker_agent.py     # 문체 검증
├── voice_checker_agent.py    # 말투 검증
├── feel_checker_agent.py     # 감정 검증
├── image_agent.py            # 이미지 에이전트
├── youtube_agent.py          # 메타데이터 에이전트
└── review_agent.py           # 최종 검토 에이전트
```

---

## 4. Series Bible 참조

모든 에이전트는 `docs/series_bible.md`를 헌법으로 참조합니다.

- 세계관 설정
- 캐릭터 프로필
- 6부 60화 플롯 구조
- 문체 가이드
