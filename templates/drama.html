<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <title>Drama Lab</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect fill='%23667eea' width='32' height='32' rx='6'/><text x='16' y='22' font-size='18' fill='white' text-anchor='middle' font-weight='bold'>D</text></svg>">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/drama.css') }}?v=20241202">
</head>
<body>
  <!-- Auth Header -->
  <div class="auth-header">
    <h1>Creator Lab</h1>
    <div class="auth-links">
      <span id="session-info" class="session-info"></span>
      <button id="btn-new-session" class="btn-header" onclick="DramaMain.newSession()">새 프로젝트</button>
      <a href="/" class="btn-home">홈</a>
    </div>
  </div>

  <!-- Main Layout with Sidebar -->
  <div class="main-layout">
    <!-- Left Sidebar Navigation -->
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <a href="/drama" class="sidebar-item active" data-page="drama">
          <span class="sidebar-icon">🎬</span>
          <span class="sidebar-label">드라마 제작</span>
        </a>
        <a href="/image" class="sidebar-item" data-page="image">
          <span class="sidebar-icon">🖼️</span>
          <span class="sidebar-label">이미지 제작</span>
        </a>
        <a href="/tubelens" class="sidebar-item" data-page="tubelens">
          <span class="sidebar-icon">📊</span>
          <span class="sidebar-label">유튜브 검색</span>
        </a>
        <a href="/product" class="sidebar-item" data-page="product">
          <span class="sidebar-icon">📦</span>
          <span class="sidebar-label">상품 제작</span>
        </a>
        <a href="/product-manage" class="sidebar-item" data-page="product-manage">
          <span class="sidebar-icon">🏷️</span>
          <span class="sidebar-label">상품관리</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content Area -->
    <div class="main-content">
      <div id="drama-app">
    <!-- Step Progress Bar -->
    <div class="step-progress">
      <div class="step-item active" data-step="1">
        <div class="step-number">1</div>
        <div class="step-label">대본 생성</div>
      </div>
      <div class="step-connector"></div>
      <div class="step-item" data-step="2">
        <div class="step-number">2</div>
        <div class="step-label">이미지 생성</div>
      </div>
      <div class="step-connector"></div>
      <div class="step-item" data-step="3">
        <div class="step-number">3</div>
        <div class="step-label">TTS 음성</div>
      </div>
      <div class="step-connector"></div>
      <div class="step-item" data-step="4">
        <div class="step-number">4</div>
        <div class="step-label">영상 제작</div>
      </div>
      <div class="step-connector"></div>
      <div class="step-item" data-step="5">
        <div class="step-number">5</div>
        <div class="step-label">업로드</div>
      </div>
    </div>

    <!-- Step Containers -->
    <div class="step-containers">
      <!-- Step 1: 대본 입력 -->
      <div id="step1-container" class="step-container active">
        <div class="step-header">
          <h2>Step 1. 대본 입력</h2>
          <p class="step-desc">대본과 이미지 프롬프트를 입력해주세요. (4개 씬 구성)</p>
        </div>

        <div class="step-content">
          <!-- YouTube 연결 상태 (상단 배치) -->
          <div id="youtube-auth-panel" class="youtube-auth-panel">
            <div class="auth-status-row">
              <span id="yt-status-icon" class="auth-icon">🔗</span>
              <span id="yt-status-text">YouTube 연결 확인 중...</span>
              <button id="btn-yt-connect" class="btn-small btn-youtube hidden" onclick="DramaStep1.connectYouTube()">YouTube 연결</button>
            </div>
          </div>

          <!-- 기본 설정 패널 -->
          <div class="config-panel">
            <div class="config-row">
              <div class="config-item">
                <label>콘텐츠 타입</label>
                <select id="content-type">
                  <option value="drama" selected>드라마/스토리</option>
                  <option value="product">상품 소개</option>
                  <option value="education">교육/정보</option>
                  <option value="shorts">📱 쇼츠/릴스</option>
                  <option value="coupang-shorts">🛒 쿠팡파트너스 쇼츠</option>
                </select>
              </div>
              <div class="config-item">
                <label>영상 형식</label>
                <select id="video-format">
                  <option value="horizontal" selected>가로 (16:9)</option>
                  <option value="vertical">세로 (9:16) - 쇼츠/릴스</option>
                </select>
              </div>
              <div class="config-item">
                <label>영상 길이</label>
                <select id="video-duration">
                  <option value="30s">30초 (쇼츠)</option>
                  <option value="60s">60초 (쇼츠)</option>
                  <option value="3min">3분</option>
                  <option value="5min" selected>5분</option>
                  <option value="10min">10분</option>
                </select>
              </div>
            </div>
            <div class="config-row">
              <div class="config-item">
                <label>채널 타입</label>
                <select id="channel-type">
                  <option value="senior-nostalgia" selected>시니어 향수 채널 (A채널)</option>
                  <option value="testimony">신앙 간증 채널</option>
                  <option value="default">일반 드라마 채널</option>
                </select>
              </div>
              <div class="config-item">
                <!-- 주인공 성별은 AI가 대본에서 자동 파악 -->
              </div>
              <div class="config-item">
                <!-- 빈 칸 (레이아웃 유지) -->
              </div>
            </div>
            <!-- 주인공 성별 (AI 자동 파악, hidden) -->
            <input type="hidden" id="protagonist-gender" value="auto">
          </div>

          <!-- TTS 음성 선택 -->
          <div class="voice-selection-section">
            <div class="section-header">
              <h3>🎙️ 나레이션 음성 선택</h3>
              <span class="section-hint">미리듣기 버튼으로 음성을 확인하세요</span>
            </div>
            <input type="hidden" id="tts-voice-quality" value="neural2">
            <input type="hidden" id="selected-voice" value="ko-KR-Neural2-A">

            <div class="voice-cards">
              <!-- 여성 음성 -->
              <div class="voice-category">
                <h4>👩 여성 음성</h4>
                <div class="voice-options">
                  <label class="voice-card selected" data-voice="ko-KR-Neural2-A" data-quality="neural2" data-gender="female">
                    <input type="radio" name="tts-voice" value="ko-KR-Neural2-A" checked>
                    <div class="voice-info">
                      <span class="voice-name">차분한 할머니</span>
                      <span class="voice-desc">Neural2-A · 따뜻하고 안정적</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Neural2-A', 'female')">▶</button>
                  </label>
                  <label class="voice-card" data-voice="ko-KR-Neural2-B" data-quality="neural2" data-gender="female">
                    <input type="radio" name="tts-voice" value="ko-KR-Neural2-B">
                    <div class="voice-info">
                      <span class="voice-name">밝은 할머니</span>
                      <span class="voice-desc">Neural2-B · 경쾌하고 친근</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Neural2-B', 'female')">▶</button>
                  </label>
                  <label class="voice-card" data-voice="ko-KR-Wavenet-A" data-quality="wavenet" data-gender="female">
                    <input type="radio" name="tts-voice" value="ko-KR-Wavenet-A">
                    <div class="voice-info">
                      <span class="voice-name">표준 여성</span>
                      <span class="voice-desc">Wavenet-A · 깔끔한 목소리</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Wavenet-A', 'female')">▶</button>
                  </label>
                </div>
              </div>

              <!-- 남성 음성 -->
              <div class="voice-category">
                <h4>👨 남성 음성</h4>
                <div class="voice-options">
                  <label class="voice-card" data-voice="ko-KR-Neural2-C" data-quality="neural2" data-gender="male">
                    <input type="radio" name="tts-voice" value="ko-KR-Neural2-C">
                    <div class="voice-info">
                      <span class="voice-name">중후한 할아버지</span>
                      <span class="voice-desc">Neural2-C · 깊고 신뢰감</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Neural2-C', 'male')">▶</button>
                  </label>
                  <label class="voice-card" data-voice="ko-KR-Wavenet-C" data-quality="wavenet" data-gender="male">
                    <input type="radio" name="tts-voice" value="ko-KR-Wavenet-C">
                    <div class="voice-info">
                      <span class="voice-name">표준 남성</span>
                      <span class="voice-desc">Wavenet-C · 명확한 발음</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Wavenet-C', 'male')">▶</button>
                  </label>
                  <label class="voice-card" data-voice="ko-KR-Wavenet-D" data-quality="wavenet" data-gender="male">
                    <input type="radio" name="tts-voice" value="ko-KR-Wavenet-D">
                    <div class="voice-info">
                      <span class="voice-name">젊은 남성</span>
                      <span class="voice-desc">Wavenet-D · 활기찬 톤</span>
                    </div>
                    <button type="button" class="btn-preview" onclick="DramaStep1.previewVoice('ko-KR-Wavenet-D', 'male')">▶</button>
                  </label>
                </div>
              </div>
            </div>

            <!-- 오디오 플레이어 (숨김) -->
            <audio id="voice-preview-player" style="display:none;"></audio>
          </div>

          <!-- 전체 대본 입력 (드라마/스토리 모드) -->
          <div id="script-input-section" class="script-input-section">
            <div class="section-header">
              <h3>📝 전체 대본 입력</h3>
              <span class="section-hint">대본 전체를 붙여넣으면 AI가 씬과 샷을 자동 분석합니다</span>
            </div>
            <textarea id="full-script" class="script-textarea" rows="15" placeholder="여기에 전체 대본을 붙여넣으세요...

예시:
[주인공: 박봉수, 70세, 작은 한식당 주인, 한국인 할아버지]

그날 밤이었습니다. 저는 46년 만에 처음으로 그 이름을 들었습니다.
작은 한식당, 김이 모락모락 나는 된장찌개가 식탁 위에 놓여 있었습니다.

젊은 남자가 낡은 흑백 사진을 꺼냈습니다.
'혹시... 이 사람 아세요?'

이창수 씨의 눈에서 눈물이 흘러내렸습니다.
46년 전 그날의 기억이 밀려왔습니다..."></textarea>

            <div class="script-actions">
              <button id="btn-analyze-script" class="btn-primary" onclick="DramaStep1.analyzeScript()">
                <span class="btn-icon">🤖</span> AI 대본 분석하기
              </button>
              <span class="action-hint">GPT가 씬과 샷을 자동으로 나눠줍니다</span>
            </div>
          </div>

          <!-- 쿠팡파트너스 상품 입력 (쿠팡 쇼츠 모드) -->
          <div id="coupang-input-section" class="script-input-section hidden">
            <div class="section-header">
              <h3>🛒 쿠팡파트너스 상품 정보</h3>
              <span class="section-hint">상품 URL 또는 상품명을 입력하면 AI가 리뷰 대본을 자동 생성합니다</span>
            </div>

            <div class="coupang-input-group">
              <label>상품 URL (쿠팡 링크)</label>
              <input type="text" id="coupang-product-url" class="input-field" placeholder="https://www.coupang.com/vp/products/...">
              <button type="button" class="btn-secondary btn-small" onclick="DramaStep1.fetchProductInfo()">
                🔍 상품 정보 가져오기
              </button>
            </div>

            <div class="coupang-divider">
              <span>또는</span>
            </div>

            <div class="coupang-input-group">
              <label>상품명 직접 입력</label>
              <input type="text" id="coupang-product-name" class="input-field" placeholder="예: 데스크캘린더, 무선 청소기, 블루투스 이어폰">
              <div class="xiaohongshu-search-row">
                <button type="button" class="btn-xiaohongshu" onclick="DramaStep1.searchXiaohongshu()">
                  📕 샤오홍수에서 영상 찾기
                </button>
                <span class="xiaohongshu-hint">한국어 → 중국어 자동 번역 후 검색</span>
              </div>
            </div>

            <!-- 샤오홍수 검색 결과 (iframe) -->
            <div id="xiaohongshu-frame-container" class="hidden">
              <div class="section-header">
                <h4>📕 샤오홍수 검색 결과</h4>
                <button type="button" class="btn-small btn-secondary" onclick="DramaStep1.closeXiaohongshuFrame()">✕ 닫기</button>
              </div>
              <div class="xiaohongshu-notice">
                ⚠️ 마음에 드는 영상을 찾으면 다운로드 후 사용하세요.
                <a href="#" id="xiaohongshu-direct-link" target="_blank">새 탭에서 열기 ↗</a>
              </div>
              <iframe id="xiaohongshu-iframe" src="" frameborder="0"></iframe>
            </div>

            <div class="coupang-input-group">
              <label>가격 (선택)</label>
              <input type="text" id="coupang-product-price" class="input-field" placeholder="예: 89,000원">
            </div>

            <div class="coupang-input-group">
              <label>핵심 장점 (선택, 쉼표로 구분)</label>
              <input type="text" id="coupang-product-features" class="input-field" placeholder="예: 강력한 흡입력, 긴 배터리, 가벼운 무게">
            </div>

            <div class="script-actions">
              <button id="btn-generate-coupang-script" class="btn-primary" onclick="DramaStep1.generateCoupangScript()">
                <span class="btn-icon">🤖</span> AI 리뷰 대본 생성
              </button>
              <span class="action-hint">상품 정보로 60초 쇼츠 대본을 자동 생성합니다</span>
            </div>

            <!-- 생성된 대본 미리보기 -->
            <div id="coupang-script-preview" class="hidden">
              <div class="section-header" style="margin-top: 20px;">
                <h4>📄 생성된 대본</h4>
              </div>
              <textarea id="coupang-generated-script" class="script-textarea" rows="8" placeholder="AI가 생성한 대본이 여기에 표시됩니다..."></textarea>
              <div class="script-actions">
                <button class="btn-primary" onclick="DramaStep1.useCoupangScript()">
                  <span class="btn-icon">✅</span> 이 대본으로 진행
                </button>
              </div>
            </div>
          </div>

          <!-- AI 분석 진행 상태 -->
          <div id="analysis-progress" class="progress-panel hidden">
            <h3>대본 분석 중...</h3>
            <div class="progress-bar-container">
              <div id="analysis-progress-bar" class="progress-bar"></div>
            </div>
            <div id="analysis-progress-text" class="progress-text">AI가 대본을 분석하고 있습니다...</div>
          </div>

          <!-- AI 분석 결과 (씬/샷 트리) -->
          <div id="analysis-result" class="analysis-result hidden">
            <div class="section-header">
              <h3>🎬 분석 결과</h3>
              <span class="section-hint">각 샷의 이미지 프롬프트와 나레이션을 확인/수정하세요</span>
            </div>
            <div id="scene-shot-tree" class="scene-shot-tree">
              <!-- JS로 동적 생성 -->
            </div>
          </div>

          <!-- 액션 버튼 -->
          <div class="action-buttons">
            <button id="btn-save-script" class="btn-primary btn-large hidden" onclick="DramaStep1.saveAnalyzedScript()">
              <span class="btn-icon">💾</span> 분석 결과 저장 및 다음 단계
            </button>
          </div>

          <!-- 저장 완료 메시지 -->
          <div id="step1-saved-notice" class="saved-notice hidden">
            <span class="notice-icon">✅</span>
            <span>대본이 저장되었습니다. 다음 단계로 진행하세요.</span>
          </div>
        </div>
      </div>

      <!-- Step 2: 이미지 생성 -->
      <div id="step2-container" class="step-container">
        <div class="step-header">
          <h2>Step 2. 이미지 생성</h2>
          <p class="step-desc">대본의 각 씬에 맞는 이미지를 AI가 생성합니다.</p>
        </div>

        <div class="step-content">
          <!-- 이미지 생성 설정 -->
          <div class="config-panel">
            <div class="config-row">
              <div class="config-item">
                <label>이미지 생성 모델</label>
                <select id="image-model">
                  <option value="gemini" selected>Google Gemini (무료)</option>
                  <option value="flux">FLUX.1 Pro (고품질)</option>
                  <option value="dalle">DALL-E 3 (OpenAI)</option>
                </select>
              </div>
              <div class="config-item">
                <label>이미지 스타일</label>
                <select id="image-style">
                  <option value="realistic" selected>사실적 (Realistic)</option>
                  <option value="cinematic">시네마틱 (Cinematic)</option>
                  <option value="warm">따뜻한 톤 (Warm)</option>
                  <option value="dramatic">드라마틱 (Dramatic)</option>
                </select>
              </div>
              <div class="config-item">
                <label>이미지 비율</label>
                <select id="image-ratio">
                  <option value="16:9" selected>16:9 (유튜브)</option>
                  <option value="9:16">9:16 (쇼츠)</option>
                  <option value="1:1">1:1 (정사각형)</option>
                </select>
              </div>
            </div>
          </div>

          <!-- 캐릭터 분석 결과 -->
          <div id="character-analysis" class="analysis-panel hidden">
            <h3>등장인물 분석</h3>
            <div id="character-list" class="character-list"></div>
          </div>

          <!-- 씬별 이미지 생성 -->
          <div id="scene-images-area" class="scene-images-area hidden">
            <div class="scene-images-header">
              <h3>씬별 이미지</h3>
              <div class="batch-actions">
                <button class="btn-small" onclick="DramaStep2.generateAllImages()">모든 이미지 생성</button>
                <button class="btn-small" onclick="DramaStep2.regenerateSelected()">선택 재생성</button>
              </div>
            </div>
            <div id="scene-image-list" class="scene-image-list"></div>
          </div>

          <!-- 썸네일 생성 섹션 -->
          <div id="thumbnail-generate-section" class="thumbnail-generate-section hidden">
            <div class="section-header">
              <h3>🖼️ 유튜브 썸네일 생성</h3>
              <span class="section-hint">클릭을 유도하는 썸네일을 AI가 생성합니다</span>
            </div>

            <div class="thumbnail-config">
              <div class="config-item">
                <label>썸네일 문구 (선택)</label>
                <input type="text" id="thumbnail-title-input" placeholder="예: 40년 만에 만난 첫사랑" maxlength="50">
              </div>
              <div class="config-item">
                <label>스타일</label>
                <select id="thumbnail-style">
                  <option value="emotional" selected>감성적 (눈물/감동)</option>
                  <option value="dramatic">드라마틱 (강렬한)</option>
                  <option value="warm">따뜻한 (가족/추억)</option>
                  <option value="mystery">미스터리 (궁금증 유발)</option>
                </select>
              </div>
            </div>

            <div class="thumbnail-actions">
              <button class="btn-primary" onclick="DramaStep2.generateThumbnail()">
                <span class="btn-icon">🎨</span> 썸네일 생성
              </button>
            </div>

            <div id="thumbnail-preview" class="thumbnail-preview hidden">
              <h4>생성된 썸네일</h4>
              <div class="thumbnail-result">
                <img id="thumbnail-image" src="" alt="썸네일">
                <div class="thumbnail-info">
                  <p id="thumbnail-text-preview"></p>
                  <button class="btn-small" onclick="DramaStep2.downloadThumbnail()">다운로드</button>
                  <button class="btn-small" onclick="DramaStep2.regenerateThumbnail()">재생성</button>
                </div>
              </div>
            </div>
          </div>

          <!-- 액션 버튼 -->
          <div class="action-buttons">
            <button id="btn-analyze-script" class="btn-primary btn-large" onclick="DramaStep2.analyzeAndPrepare()">
              <span class="btn-icon">🎨</span> 대본 분석 및 이미지 준비
            </button>
          </div>

          <!-- 다음 단계 버튼 -->
          <div id="step2-next" class="next-step-buttons hidden">
            <button class="btn-secondary" onclick="DramaMain.goToStep(1)">← Step 1: 대본</button>
            <button class="btn-primary" onclick="DramaMain.goToStep(3)">Step 3: TTS 음성 →</button>
          </div>
        </div>
      </div>

      <!-- Step 3: TTS 음성합성 -->
      <div id="step3-container" class="step-container">
        <div class="step-header">
          <h2>Step 3. TTS 음성합성</h2>
          <p class="step-desc">대본을 자연스러운 음성으로 변환합니다.</p>
        </div>

        <div class="step-content">
          <!-- TTS 설정 -->
          <div class="config-panel">
            <div class="config-row">
              <div class="config-item">
                <label>TTS 엔진</label>
                <select id="tts-engine">
                  <option value="google" selected>Google Cloud TTS</option>
                  <option value="naver">네이버 클로바</option>
                </select>
              </div>
              <div class="config-item">
                <label>음성 스타일</label>
                <select id="voice-style">
                  <option value="warm" selected>따뜻한 (시니어 친화)</option>
                  <option value="neutral">중립적</option>
                  <option value="dramatic">드라마틱</option>
                </select>
              </div>
              <div class="config-item">
                <label>말하기 속도</label>
                <select id="speech-rate">
                  <option value="0.85">느리게 (0.85x)</option>
                  <option value="0.95" selected>약간 느리게 (0.95x)</option>
                  <option value="1.0">보통 (1.0x)</option>
                  <option value="1.1">약간 빠르게 (1.1x)</option>
                </select>
              </div>
            </div>
          </div>

          <!-- 음성 할당 -->
          <div id="voice-assignment" class="voice-assignment-panel hidden">
            <h3>캐릭터별 음성 할당</h3>
            <div id="voice-assignment-list" class="voice-assignment-list"></div>
          </div>

          <!-- TTS 생성 진행 상황 -->
          <div id="tts-progress" class="progress-panel hidden">
            <h3>음성 생성 진행</h3>
            <div class="progress-bar-container">
              <div id="tts-progress-bar" class="progress-bar"></div>
            </div>
            <div id="tts-progress-text" class="progress-text">준비 중...</div>
          </div>

          <!-- 생성된 음성 목록 -->
          <div id="tts-result-area" class="tts-result-area hidden">
            <h3>생성된 음성</h3>
            <div id="tts-audio-list" class="tts-audio-list"></div>
            <div class="tts-summary">
              <span id="tts-total-duration">총 재생 시간: -</span>
              <button class="btn-small" onclick="DramaStep3.playAll()">전체 재생</button>
              <button class="btn-small" onclick="DramaStep3.downloadAll()">전체 다운로드</button>
            </div>
          </div>

          <!-- 액션 버튼 -->
          <div class="action-buttons">
            <button id="btn-generate-tts" class="btn-primary btn-large" onclick="DramaStep3.generateTTS()">
              <span class="btn-icon">🎙️</span> 음성 생성하기
            </button>
          </div>

          <!-- 다음 단계 버튼 -->
          <div id="step3-next" class="next-step-buttons hidden">
            <button class="btn-secondary" onclick="DramaMain.goToStep(2)">← Step 2: 이미지</button>
            <button class="btn-primary" onclick="DramaMain.goToStep(4)">Step 4: 영상 제작 →</button>
          </div>
        </div>
      </div>

      <!-- Step 4: 씬별 클립 다운로드 -->
      <div id="step4-container" class="step-container">
        <div class="step-header">
          <h2>Step 4. 씬별 클립 다운로드</h2>
          <p class="step-desc">각 씬의 이미지+오디오를 MP4로 변환하여 다운로드합니다.<br>다운로드 후 CapCut 등에서 자유롭게 편집하세요!</p>
        </div>

        <div class="step-content">
          <!-- 안내 메시지 -->
          <div class="info-panel">
            <div class="info-icon">💡</div>
            <div class="info-text">
              <strong>씬별 MP4 클립</strong>을 다운로드하여 CapCut, Premiere 등에서 편집하세요.
              <ul>
                <li>각 씬: 이미지 + TTS 오디오 → MP4 변환</li>
                <li>추가 이미지나 효과를 자유롭게 삽입 가능</li>
                <li>720p 해상도, H.264 코덱</li>
              </ul>
            </div>
          </div>

          <!-- 씬 클립 목록 -->
          <div id="scene-clips-list" class="scene-clips-list">
            <h3>📁 생성할 클립 목록</h3>
            <div id="scene-clips-items" class="scene-clips-items">
              <!-- JS로 동적 생성 -->
              <div class="empty-message">Step 2, 3을 먼저 완료해주세요.</div>
            </div>
          </div>

          <!-- 진행 상황 -->
          <div id="clip-progress" class="progress-panel hidden">
            <h3>클립 생성 진행</h3>
            <div class="progress-bar-container">
              <div id="clip-progress-bar" class="progress-bar"></div>
            </div>
            <div id="clip-progress-text" class="progress-text">준비 중...</div>
          </div>

          <!-- 다운로드 결과 -->
          <div id="clip-download-area" class="download-area hidden">
            <h3>✅ 다운로드 준비 완료</h3>
            <div class="download-info">
              <span id="clip-count">클립 수: -</span>
              <span id="zip-size">파일 크기: -</span>
            </div>
            <button class="btn-primary btn-large" id="btn-download-zip" onclick="DramaStep4.triggerDownload()">
              <span class="btn-icon">📦</span> ZIP 다운로드
            </button>
          </div>

          <!-- 액션 버튼 -->
          <div class="action-buttons">
            <button id="btn-create-clips" class="btn-primary btn-large" onclick="DramaStep4.createSceneClips()">
              <span class="btn-icon">🎬</span> 씬별 클립 생성하기
            </button>
          </div>

          <!-- 다음 단계 버튼 -->
          <div id="step4-next" class="next-step-buttons">
            <button class="btn-secondary" onclick="DramaMain.goToStep(3)">← Step 3: TTS</button>
          </div>
        </div>
      </div>

      <!-- Step 5: YouTube 업로드 -->
      <div id="step5-container" class="step-container">
        <div class="step-header">
          <h2>Step 5. YouTube 업로드</h2>
          <p class="step-desc">완성된 영상을 YouTube에 업로드합니다.</p>
        </div>

        <div class="step-content">
          <!-- YouTube 연결 상태 -->
          <div id="youtube-auth-status" class="auth-status-panel">
            <div class="auth-status-icon">🔗</div>
            <div class="auth-status-text">YouTube 계정 연결 확인 중...</div>
            <button id="btn-youtube-connect" class="btn-secondary hidden" onclick="DramaStep5.connectYouTube()">YouTube 연결</button>
          </div>

          <!-- 썸네일 선택 -->
          <div id="thumbnail-section" class="thumbnail-section hidden">
            <h3>썸네일 선택</h3>
            <div id="thumbnail-options" class="thumbnail-options"></div>
            <button class="btn-small" onclick="DramaStep5.generateThumbnails()">새 썸네일 생성</button>
          </div>

          <!-- 메타데이터 입력 -->
          <div id="upload-metadata" class="upload-metadata-panel hidden">
            <h3>영상 정보</h3>
            <div class="metadata-form">
              <div class="form-group">
                <label>제목</label>
                <input type="text" id="video-title" placeholder="영상 제목">
              </div>
              <div class="form-group">
                <label>설명</label>
                <textarea id="video-description" rows="5" placeholder="영상 설명"></textarea>
              </div>
              <div class="form-group">
                <label>태그</label>
                <input type="text" id="video-tags" placeholder="태그1, 태그2, 태그3">
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <label>카테고리</label>
                  <select id="video-category">
                    <option value="22">사람 및 블로그</option>
                    <option value="27" selected>교육</option>
                    <option value="24">엔터테인먼트</option>
                    <option value="29">비영리/사회운동</option>
                  </select>
                </div>
                <div class="form-group half">
                  <label>공개 설정</label>
                  <select id="video-privacy">
                    <option value="private" selected>비공개</option>
                    <option value="unlisted">일부 공개</option>
                    <option value="public">공개</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- 업로드 진행 상황 -->
          <div id="upload-progress" class="progress-panel hidden">
            <h3>업로드 진행</h3>
            <div class="progress-bar-container">
              <div id="upload-progress-bar" class="progress-bar"></div>
            </div>
            <div id="upload-progress-text" class="progress-text">준비 중...</div>
          </div>

          <!-- 업로드 완료 -->
          <div id="upload-complete" class="upload-complete-panel hidden">
            <div class="complete-icon">✅</div>
            <h3>업로드 완료!</h3>
            <a id="youtube-link" href="#" target="_blank" class="youtube-link">YouTube에서 보기</a>
            <div class="share-buttons">
              <button class="btn-small" onclick="DramaStep5.copyLink()">링크 복사</button>
              <button class="btn-small" onclick="DramaStep5.shareKakao()">카카오톡 공유</button>
            </div>
          </div>

          <!-- 액션 버튼 -->
          <div class="action-buttons">
            <button id="btn-upload" class="btn-primary btn-large" onclick="DramaStep5.uploadToYouTube()">
              <span class="btn-icon">📤</span> YouTube에 업로드
            </button>
          </div>

          <!-- 이전 단계 버튼 -->
          <div class="next-step-buttons">
            <button class="btn-secondary" onclick="DramaMain.goToStep(4)">← Step 4: 영상 제작</button>
            <button class="btn-primary" onclick="DramaMain.newSession()">새 프로젝트 시작</button>
          </div>
        </div>
      </div>
    </div>
      </div><!-- /main-content -->
  </div><!-- /main-layout -->

  <!-- 로딩 오버레이 -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">로딩 중...</div>
    <div class="loading-subtext"></div>
  </div>

  <!-- 상태바 -->
  <div id="status-bar" class="status-bar"></div>

  <!-- JavaScript (v=20241202) -->
  <script src="{{ url_for('static', filename='js/drama-utils.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-session.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-main.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-step1.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-step2.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-step3.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-step4.js') }}?v=20241202"></script>
  <script src="{{ url_for('static', filename='js/drama-step5.js') }}?v=20241202"></script>
</body>
</html>
