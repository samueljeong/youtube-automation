<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI íŒë§¤ ì½˜í…ì¸  ìƒì„±ê¸°</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 2rem;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      color: white;
      margin-bottom: 2rem;
    }
    .header h1 {
      font-size: 2.5rem;
      margin-bottom: .5rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }
    .main-grid {
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 1.5rem;
    }
    .box {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .box-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 1.25rem;
      padding-bottom: 0.75rem;
      border-bottom: 3px solid #667eea;
    }
    .label {
      display: block;
      font-weight: 600;
      color: #334155;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }
    input[type="text"], input[type="number"], select, textarea {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 0.95rem;
      transition: all 0.2s;
      font-family: inherit;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    textarea {
      min-height: 100px;
      resize: vertical;
      line-height: 1.6;
    }
    .input-group {
      margin-bottom: 1.25rem;
    }
    
    /* ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ */
    .image-upload-area {
      border: 3px dashed #cbd5e1;
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
      background: #f8fafc;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 1rem;
    }
    .image-upload-area:hover {
      border-color: #667eea;
      background: #f0f4ff;
    }
    .image-upload-area.dragover {
      border-color: #667eea;
      background: #e0e7ff;
      transform: scale(1.02);
    }
    .upload-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    .image-preview-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 0.75rem;
      margin-top: 1rem;
    }
    .image-preview-item {
      position: relative;
      aspect-ratio: 1;
      border-radius: 12px;
      overflow: hidden;
      border: 2px solid #e2e8f0;
    }
    .image-preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .image-preview-item .remove-btn {
      position: absolute;
      top: 4px;
      right: 4px;
      background: rgba(239, 68, 68, 0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      cursor: pointer;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .image-count {
      display: inline-block;
      background: #667eea;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    /* ë²„íŠ¼ */
    button {
      width: 100%;
      padding: 0.875rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      color: white;
    }
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    .btn-primary:disabled {
      background: #94a3b8;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .btn-secondary {
      background: #64748b;
      margin-top: 0.75rem;
    }
    .btn-secondary:hover {
      background: #475569;
    }
    .btn-small {
      width: auto;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      margin-top: 0.75rem;
    }
    
    /* ê²°ê³¼ ë°•ìŠ¤ */
    .result-section {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    .result-section h3 {
      color: #667eea;
      margin-bottom: 1rem;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .result-content {
      background: white;
      padding: 1.25rem;
      border-radius: 12px;
      line-height: 1.8;
      white-space: pre-wrap;
      max-height: 600px;
      overflow-y: auto;
      font-size: 0.95rem;
    }
    .copy-btn {
      background: #10b981;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 600;
    }
    .copy-btn:hover {
      background: #059669;
    }
    
    /* íƒ­ */
    .tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .tab {
      padding: 0.75rem 1.5rem;
      border: 2px solid #e2e8f0;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      color: #64748b;
      transition: all 0.2s;
    }
    .tab:hover {
      border-color: #cbd5e1;
    }
    .tab.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    /* ë¡œë”© */
    .loading {
      display: none;
      text-align: center;
      padding: 2rem;
    }
    .loading.show {
      display: block;
    }
    .spinner {
      border: 4px solid #f3f4f6;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* ì•Œë¦¼ */
    .alert {
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 1rem;
      font-weight: 500;
    }
    .alert-info {
      background: #dbeafe;
      color: #1e40af;
      border: 2px solid #93c5fd;
    }
    .alert-success {
      background: #d1fae5;
      color: #065f46;
      border: 2px solid #6ee7b7;
    }
    .alert-warning {
      background: #fef3c7;
      color: #92400e;
      border: 2px solid #fbbf24;
    }
    
    /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
    .result-content::-webkit-scrollbar {
      width: 8px;
    }
    .result-content::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 10px;
    }
    .result-content::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 10px;
    }
    .result-content::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    @media (max-width: 1024px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸš€ AI íŒë§¤ ì½˜í…ì¸  ìƒì„±ê¸°</h1>
      <p>ì œí’ˆ ì‚¬ì§„ê³¼ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ë„¤ì´ë²„Â·ì¿ íŒ¡ ìµœì í™” ì½˜í…ì¸ ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤</p>
    </div>

    <div class="main-grid">
      <!-- ì™¼ìª½: ì…ë ¥ -->
      <div>
        <div class="box">
          <div class="box-title">
            ğŸ“¸ ì œí’ˆ ì´ë¯¸ì§€ 
            <span class="image-count" id="image-count">0/5</span>
          </div>
          
          <div class="image-upload-area" id="upload-area">
            <div class="upload-icon">ğŸ“·</div>
            <p style="font-size: 1.1rem; color: #475569; font-weight: 600; margin-bottom: 0.5rem;">
              í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•´ì„œ ì´ë¯¸ì§€ ì—…ë¡œë“œ
            </p>
            <p style="font-size: 0.9rem; color: #94a3b8;">
              ìµœëŒ€ 5ì¥ | JPG, PNG, WEBP
            </p>
          </div>
          <input type="file" id="file-input" multiple accept="image/*" style="display: none;">
          
          <div class="image-preview-grid" id="preview-grid"></div>
        </div>

        <div class="box" style="margin-top: 1.5rem;">
          <div class="box-title">ğŸ“ ì œí’ˆ ì •ë³´</div>
          
          <div class="input-group">
            <label class="label">ì œí’ˆëª…</label>
            <input type="text" id="product-name" placeholder="ì˜ˆ: í”„ë¦¬ë¯¸ì—„ ë¬´ì„  ë¸”ë£¨íˆ¬ìŠ¤ ì´ì–´í°">
          </div>
          
          <div class="input-group">
            <label class="label">ì œí’ˆ ì„¤ëª…</label>
            <textarea id="product-desc" placeholder="ì œí’ˆì˜ ì£¼ìš” íŠ¹ì§•, ì¬ì§ˆ, ìš©ë„ ë“±ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
          </div>
          
          <div class="input-group">
            <label class="label">íŒë§¤ ê°€ê²© (ì›)</label>
            <input type="number" id="product-price" placeholder="29900">
          </div>
          
          <div class="input-group">
            <label class="label">íƒ€ê²Ÿ ê³ ê°</label>
            <select id="target-customer">
              <option value="ì¼ë°˜">ì¼ë°˜</option>
              <option value="20ëŒ€ì—¬ì„±">20ëŒ€ ì—¬ì„±</option>
              <option value="30ëŒ€ì§ì¥ì¸">30ëŒ€ ì§ì¥ì¸</option>
              <option value="ì£¼ë¶€">ì£¼ë¶€</option>
              <option value="ì‹œë‹ˆì–´">ì‹œë‹ˆì–´</option>
              <option value="í•™ìƒ">í•™ìƒ</option>
            </select>
          </div>
          
          <div class="input-group">
            <label class="label">ì½˜í…ì¸  ìŠ¤íƒ€ì¼</label>
            <select id="content-style">
              <option value="ê°ì„±í˜•">ê°ì„±í˜• (ìŠ¤í† ë¦¬í…”ë§)</option>
              <option value="ì´ì„±í˜•">ì´ì„±í˜• (ìŠ¤í™ ì¤‘ì‹¬)</option>
              <option value="í˜¼í•©í˜•">í˜¼í•©í˜• (ê· í˜•)</option>
            </select>
          </div>
          
          <button class="btn-primary" id="btn-generate" disabled>
            âœ¨ ëª¨ë“  ì½˜í…ì¸  ìƒì„±í•˜ê¸°
          </button>
          
          <button class="btn-secondary btn-small" id="btn-quality">
            ğŸ” ì´ë¯¸ì§€ í’ˆì§ˆ ë¶„ì„
          </button>
          
          <button class="btn-secondary btn-small" id="btn-thumbnail">
            ğŸ¯ ì¸ë„¤ì¼ ì¶”ì²œ
          </button>
          
          <button class="btn-secondary btn-small" id="btn-competitor">
            ğŸ“Š ê²½ìŸì‚¬ ë¶„ì„
          </button>
        </div>
      </div>

      <!-- ì˜¤ë¥¸ìª½: ê²°ê³¼ -->
      <div>
        <div class="box">
          <div class="tabs">
            <div class="tab active" data-tab="all">ğŸ“¦ ì „ì²´ ì½˜í…ì¸ </div>
            <div class="tab" data-tab="quality">ğŸ” í’ˆì§ˆ ë¶„ì„</div>
            <div class="tab" data-tab="thumbnail">ğŸ¯ ì¸ë„¤ì¼</div>
            <div class="tab" data-tab="competitor">ğŸ“Š ê²½ìŸ ë¶„ì„</div>
            <div class="tab" data-tab="target">ğŸ­ íƒ€ê²Ÿë³„</div>
            <div class="tab" data-tab="social">ğŸ“± ì†Œì…œë¯¸ë””ì–´</div>
          </div>
          
          <!-- ë¡œë”© -->
          <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="color: #64748b; font-weight: 600;">AIê°€ ì½˜í…ì¸ ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
          </div>
          
          <!-- ì „ì²´ ì½˜í…ì¸  -->
          <div class="tab-content" id="content-all">
            <div class="alert alert-info">
              ğŸ‘ˆ ì™¼ìª½ì—ì„œ ì œí’ˆ ì´ë¯¸ì§€ì™€ ì •ë³´ë¥¼ ì…ë ¥í•œ í›„ ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”!
            </div>
          </div>
          
          <!-- í’ˆì§ˆ ë¶„ì„ -->
          <div class="tab-content" id="content-quality" style="display: none;">
            <div class="alert alert-info">
              ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•œ í›„ "ì´ë¯¸ì§€ í’ˆì§ˆ ë¶„ì„" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
            </div>
          </div>
          
          <!-- ì¸ë„¤ì¼ ì¶”ì²œ -->
          <div class="tab-content" id="content-thumbnail" style="display: none;">
            <div class="alert alert-info">
              2ì¥ ì´ìƒì˜ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•œ í›„ "ì¸ë„¤ì¼ ì¶”ì²œ" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
            </div>
          </div>
          
          <!-- ê²½ìŸ ë¶„ì„ -->
          <div class="tab-content" id="content-competitor" style="display: none;">
            <div class="alert alert-info">
              ì œí’ˆëª…ê³¼ ê°€ê²©ì„ ì…ë ¥í•œ í›„ "ê²½ìŸì‚¬ ë¶„ì„" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
            </div>
          </div>
          
          <!-- íƒ€ê²Ÿë³„ -->
          <div class="tab-content" id="content-target" style="display: none;">
            <div class="alert alert-info">
              íƒ€ê²Ÿ ê³ ê°ì„ ì„ íƒí•˜ê³  ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
            </div>
          </div>
          
          <!-- ì†Œì…œë¯¸ë””ì–´ -->
          <div class="tab-content" id="content-social" style="display: none;">
            <div class="input-group">
              <label class="label">í”Œë«í¼ ì„ íƒ</label>
              <select id="social-platform">
                <option value="ì¸ìŠ¤íƒ€ê·¸ë¨">ì¸ìŠ¤íƒ€ê·¸ë¨</option>
                <option value="í˜ì´ìŠ¤ë¶">í˜ì´ìŠ¤ë¶</option>
                <option value="ë¸”ë¡œê·¸">ë¸”ë¡œê·¸</option>
                <option value="ìœ íŠœë¸Œ">ìœ íŠœë¸Œ</option>
              </select>
            </div>
            <button class="btn-primary btn-small" id="btn-social">
              ğŸ“± ì†Œì…œë¯¸ë””ì–´ ì½˜í…ì¸  ìƒì„±
            </button>
            <div id="social-result" style="margin-top: 1rem;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
  let uploadedImages = [];
  let currentTab = 'all';

  // DOM ìš”ì†Œ
  const uploadArea = document.getElementById('upload-area');
  const fileInput = document.getElementById('file-input');
  const previewGrid = document.getElementById('preview-grid');
  const imageCount = document.getElementById('image-count');
  const generateBtn = document.getElementById('btn-generate');
  const loading = document.getElementById('loading');

  // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ í´ë¦­
  uploadArea.addEventListener('click', () => fileInput.click());

  // íŒŒì¼ ì„ íƒ
  fileInput.addEventListener('change', (e) => {
    handleFiles(e.target.files);
  });

  // ë“œë˜ê·¸ ì•¤ ë“œë¡­
  uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('dragover');
  });

  uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
  });

  uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    handleFiles(e.dataTransfer.files);
  });

  // íŒŒì¼ ì²˜ë¦¬
  function handleFiles(files) {
    const maxFiles = 5;
    const remainingSlots = maxFiles - uploadedImages.length;
    
    if (remainingSlots <= 0) {
      alert('ìµœëŒ€ 5ì¥ê¹Œì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      return;
    }
    
    const filesToAdd = Array.from(files).slice(0, remainingSlots);
    
    filesToAdd.forEach(file => {
      if (!file.type.startsWith('image/')) return;
      if (file.size > 5 * 1024 * 1024) {
        alert(`${file.name}ì€(ëŠ”) 5MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.`);
        return;
      }
      
      uploadedImages.push(file);
      
      // ë¯¸ë¦¬ë³´ê¸°
      const reader = new FileReader();
      reader.onload = (e) => {
        const div = document.createElement('div');
        div.className = 'image-preview-item';
        div.innerHTML = `
          <img src="${e.target.result}" alt="Preview">
          <button class="remove-btn" onclick="removeImage(${uploadedImages.length - 1})">Ã—</button>
        `;
        previewGrid.appendChild(div);
      };
      reader.readAsDataURL(file);
    });
    
    updateImageCount();
    checkGenerateButton();
  }

  // ì´ë¯¸ì§€ ì œê±°
  window.removeImage = function(index) {
    uploadedImages.splice(index, 1);
    renderPreviews();
    updateImageCount();
    checkGenerateButton();
  };

  // ë¯¸ë¦¬ë³´ê¸° ë‹¤ì‹œ ê·¸ë¦¬ê¸°
  function renderPreviews() {
    previewGrid.innerHTML = '';
    uploadedImages.forEach((file, idx) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        const div = document.createElement('div');
        div.className = 'image-preview-item';
        div.innerHTML = `
          <img src="${e.target.result}" alt="Preview">
          <button class="remove-btn" onclick="removeImage(${idx})">Ã—</button>
        `;
        previewGrid.appendChild(div);
      };
      reader.readAsDataURL(file);
    });
  }

  // ì´ë¯¸ì§€ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
  function updateImageCount() {
    imageCount.textContent = `${uploadedImages.length}/5`;
  }

  // ìƒì„± ë²„íŠ¼ í™œì„±í™” ì²´í¬
  function checkGenerateButton() {
    const hasImages = uploadedImages.length > 0;
    const hasName = document.getElementById('product-name').value.trim() !== '';
    generateBtn.disabled = !(hasImages && hasName);
  }

  document.getElementById('product-name').addEventListener('input', checkGenerateButton);

  // íƒ­ ì „í™˜
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      const tabName = tab.dataset.tab;
      currentTab = tabName;
      
      document.querySelectorAll('.tab-content').forEach(tc => tc.style.display = 'none');
      document.getElementById('content-' + tabName).style.display = 'block';
    });
  });

  // ì „ì²´ ì½˜í…ì¸  ìƒì„±
  generateBtn.addEventListener('click', async () => {
    loading.classList.add('show');
    
    const formData = new FormData();
    uploadedImages.forEach(img => formData.append('images', img));
    formData.append('product_name', document.getElementById('product-name').value);
    formData.append('product_desc', document.getElementById('product-desc').value);
    formData.append('price', document.getElementById('product-price').value);
    formData.append('target', document.getElementById('target-customer').value);
    formData.append('style', document.getElementById('content-style').value);
    
    try {
      const res = await fetch('/api/content/generate-all', {
        method: 'POST',
        body: formData
      });
      const data = await res.json();
      
      if (data.ok) {
        showResult('all', data.result);
      } else {
        showError('all', data.error);
      }
    } catch (err) {
      showError('all', err.message);
    } finally {
      loading.classList.remove('show');
    }
  });

  // ì´ë¯¸ì§€ í’ˆì§ˆ ë¶„ì„
  document.getElementById('btn-quality').addEventListener('click', async () => {
    if (uploadedImages.length === 0) {
      alert('ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.');
      return;
    }
    
    switchTab('quality');
    loading.classList.add('show');
    
    const formData = new FormData();
    uploadedImages.forEach(img => formData.append('images', img));
    
    try {
      const res = await fetch('/api/content/analyze-quality', {
        method: 'POST',
        body: formData
      });
      const data = await res.json();
      
      if (data.ok) {
        showResult('quality', data.result);
      } else {
        showError('quality', data.error);
      }
    } catch (err) {
      showError('quality', err.message);
    } finally {
      loading.classList.remove('show');
    }
  });

  // ì¸ë„¤ì¼ ì¶”ì²œ
  document.getElementById('btn-thumbnail').addEventListener('click', async () => {
    if (uploadedImages.length < 2) {
      alert('ë¹„êµí•  ì´ë¯¸ì§€ê°€ 2ì¥ ì´ìƒ í•„ìš”í•©ë‹ˆë‹¤.');
      return;
    }
    
    switchTab('thumbnail');
    loading.classList.add('show');
    
    const formData = new FormData();
    uploadedImages.forEach(img => formData.append('images', img));
    
    try {
      const res = await fetch('/api/content/recommend-thumbnail', {
        method: 'POST',
        body: formData
      });
      const data = await res.json();
      
      if (data.ok) {
        showResult('thumbnail', data.result);
      } else {
        showError('thumbnail', data.error);
      }
    } catch (err) {
      showError('thumbnail', err.message);
    } finally {
      loading.classList.remove('show');
    }
  });

  // ê²½ìŸì‚¬ ë¶„ì„
  document.getElementById('btn-competitor').addEventListener('click', async () => {
    const productName = document.getElementById('product-name').value;
    const price = document.getElementById('product-price').value;
    
    if (!productName) {
      alert('ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
      return;
    }
    
    switchTab('competitor');
    loading.classList.add('show');
    
    try {
      const res = await fetch('/api/content/competitor-analysis', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          product_name: productName,
          price: price
        })
      });
      const data = await res.json();
      
      if (data.ok) {
        showResult('competitor', data.result);
      } else {
        showError('competitor', data.error);
      }
    } catch (err) {
      showError('competitor', err.message);
    } finally {
      loading.classList.remove('show');
    }
  });

  // ì†Œì…œë¯¸ë””ì–´ ì½˜í…ì¸ 
  document.getElementById('btn-social').addEventListener('click', async () => {
    const productName = document.getElementById('product-name').value;
    const productDesc = document.getElementById('product-desc').value;
    const platform = document.getElementById('social-platform').value;
    
    if (!productName) {
      alert('ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
      return;
    }
    
    loading.classList.add('show');
    
    try {
      const res = await fetch('/api/content/social-media', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          product_name: productName,
          product_desc: productDesc,
          platform: platform
        })
      });
      const data = await res.json();
      
      if (data.ok) {
        document.getElementById('social-result').innerHTML = createResultHTML(data.result);
      } else {
        document.getElementById('social-result').innerHTML = `<div class="alert alert-warning">ì˜¤ë¥˜: ${data.error}</div>`;
      }
    } catch (err) {
      document.getElementById('social-result').innerHTML = `<div class="alert alert-warning">ì˜¤ë¥˜: ${err.message}</div>`;
    } finally {
      loading.classList.remove('show');
    }
  });

  // íƒ­ ì „í™˜ í—¬í¼
  function switchTab(tabName) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
    document.querySelectorAll('.tab-content').forEach(tc => tc.style.display = 'none');
    document.getElementById('content-' + tabName).style.display = 'block';
  }

  // ê²°ê³¼ í‘œì‹œ
  function showResult(tab, content) {
    const container = document.getElementById('content-' + tab);
    container.innerHTML = createResultHTML(content);
  }

  // ì—ëŸ¬ í‘œì‹œ
  function showError(tab, error) {
    const container = document.getElementById('content-' + tab);
    container.innerHTML = `<div class="alert alert-warning">âš ï¸ ì˜¤ë¥˜ ë°œìƒ: ${error}</div>`;
  }

  // ê²°ê³¼ HTML ìƒì„±
  function createResultHTML(content) {
    return `
      <div class="result-section">
        <h3>
          ìƒì„±ëœ ì½˜í…ì¸ 
          <button class="copy-btn" onclick="copyToClipboard(this)">ğŸ“‹ ì „ì²´ ë³µì‚¬</button>
        </h3>
        <div class="result-content">${formatContent(content)}</div>
      </div>
    `;
  }

  // ì½˜í…ì¸  í¬ë§·íŒ…
  function formatContent(text) {
    return text
      .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
      .replace(/###\s(.+)/g, '<h3 style="color: #667eea; margin: 1.5rem 0 0.75rem 0; font-size: 1.2rem;">$1</h3>')
      .replace(/##\s(.+)/g, '<h2 style="color: #764ba2; margin: 1.5rem 0 0.75rem 0; font-size: 1.4rem;">$1</h2>')
      .replace(/\n/g, '<br>');
  }

  // í´ë¦½ë³´ë“œ ë³µì‚¬
  window.copyToClipboard = function(btn) {
    const content = btn.parentElement.nextElementSibling.innerText;
    navigator.clipboard.writeText(content).then(() => {
      const originalText = btn.textContent;
      btn.textContent = 'âœ… ë³µì‚¬ë¨!';
      btn.style.background = '#10b981';
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = '';
      }, 2000);
    });
  };
  </script>
</body>
</html>